@model GetWayPro.Models.Post

@{
    ViewData["Title"] = "Add Post";
}
<body class="text-light" style="background-color: rgb(99, 39, 120);">

<form asp-action="AddPost" method="post" enctype="multipart/form-data">
    <div class="container rounded bg-white mt-5 mb-5">
        <div class="row">
            

            <div class="col-md-5 border-right">
                <div class="p-3 py-5">
                        <div class="card-header bg-primary text-white text-center">

                        <h4 class="text-right">Add Post</h4>
                    </div>

                   

                    <div class="row mt-2">
                        <div class="col-md-12 mb-3">
                            <input asp-for="Title" class="form-control" placeholder="Enter title" required />
                        </div>
                        <div class="col-md-12 mb-3">
                            <textarea asp-for="Description" class="form-control" rows="5" placeholder="Enter description" required></textarea>
                        </div>
                        <div class="col-md-12 mb-3">
                            <label class="labels">Image</label>
                            <input type="file" class="form-control" name="ImageFile" accept="image/*" />
                        </div>
                    </div>

                    <div class="mt-3 text-center">
                            <button type="submit" class="btn btn-primary profile-button w-100">Save Post</button>
                        </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="p-3 py-5">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span>Actions</span>
                    </div>
                        
                    <div class="mt-3">
                        <a class="btn btn-outline-secondary w-100 mb-2" asp-controller="Users" asp-action="myProfile">
                            <i class="fa fa-arrow-left"></i> Back to Profile
                        </a>
                    </div>

                    
                </div>
            </div>

        </div>
    </div>
</form>

    @section Scripts {
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <script>
            document.querySelector("form").addEventListener("submit", function (e) {
                e.preventDefault();

                Swal.fire({
                    title: "Do you want to save the changes?",
                    showDenyButton: true,
                    showCancelButton: true,
                    confirmButtonText: "Save",
                    denyButtonText: `Don't save`
                }).then((result) => {
                    if (result.isConfirmed) {
                        e.target.submit();
                    } else if (result.isDenied) {
                        Swal.fire("Changes are not saved", "", "info");
                    }
                });
            });

            // ✅ عرض SweetAlert إذا تم الحفظ بنجاح (باستخدام Session)
            @if (Context.Session.GetString("PostAdded") == "true")
            {
                    // حذف القيمة من الجلسة بعد الاستخدام
                    Context.Session.Remove("PostAdded");

                <text>
                    Swal.fire("Saved!", "Your post was added successfully!", "success");
                </text>
            }
        </script>
    }


</body>